{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/coffee-to-babel/","webpackCompilationHash":"7a76817dbaf0db308696","result":{"data":{"markdownRemark":{"id":"041a3047-b6db-5a43-a6e1-8c5dff9f6e37","html":"<p>Recently I was tasked with modernizing a CoffeeScript codebase to use Babel. I’ve used babel (and 6to5) across various projects for almost two years, not to mention I have been writing CoffeeScript since it has been in the hands of the public. I was told to convert the code to coffee to babel as quickly as I could. Fortunately the project I was working with was already setup with webpack which made using the <code class=\"language-text\">babel-loader</code> alongside the <code class=\"language-text\">coffee-loader</code> a possibility if I failed to convert everything on time. With that in mind I configured a basic <code class=\"language-text\">.eslintrc</code> and <code class=\"language-text\">.babelrc</code> and started the process of translation.</p>\n<p>Surprisingly the process didn’t start with actual translations. Manual translation would not be quick enough. Dredging through hundreds of coffee files was going to take me way more time than I had. So I started searching around for tools that could convert CoffeeScript to Babel. Tons of tools exist, but nothing to do this exact conversion. Luckily you can get something working pretty well if you use the right combination of tools. You will come across some files that don’t fully convert, and you may even need to tweak the conversion tool to get it working to your liking. Given a time crunch like I had, you would be glad to have this as an option.</p>\n<h3 id=\"cjsx-codemod\"><a href=\"#cjsx-codemod\" aria-label=\"cjsx codemod permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/jsdf/cjsx-codemod\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CJSX-Codemod</a></h3>\n<p>If you aren’t using JSX, or you don’t know what JSX is, you can ignore this tool. It is only required if you were previously using JSX, and you can move on to the next tool I used in this process. For everyone else, this tool lets us convert JSX to coffee. So lines like <code class=\"language-text\">&lt;div /&gt;</code> will translate to <code class=\"language-text\">React.createElement(&#39;div&#39;, null)</code>. You can globally install this package and then run it over a directory of scripts of your choosing. It will fire off some workers and tell you if it had any trouble along the way. If you are lucky everything will go smoothly. I recommend sanity checking throughout each step, and committing the changes that you are making so you don’t end up wasting any time.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> global <span class=\"token function\">add</span> cjsx-codemod\ncjsx-codemod ./scripts</code></pre></div>\n<h3 id=\"decaffeinate\"><a href=\"#decaffeinate\" aria-label=\"decaffeinate permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/decaffeinate/decaffeinate\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Decaffeinate</a></h3>\n<p>This next tool will convert a coffee file to a babel compatible file. I couldn’t find a great way to run the tool over a directory of scripts. Fortunately you can just run the command on a list of coffee files by piping it through xargs. If you don’t know what the command below does let me explain. I search for files in a folder of my choice and then filter by coffee files. Next I run the decaffeinate command on each file that has been found. You should end up with a bunch of new javascript files, and your existing coffee files should remain untouched. Feel free to delete the coffee files now that they are unnecessary.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> global <span class=\"token function\">add</span> decaffeinate\n<span class=\"token function\">find</span> ./scripts <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> .coffee <span class=\"token operator\">|</span> <span class=\"token function\">xargs</span> -n 1 -P 5 decaffeinate</code></pre></div>\n<h3 id=\"react-codemod\"><a href=\"#react-codemod\" aria-label=\"react codemod permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/reactjs/react-codemod\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React-Codemod</a></h3>\n<p>Again, you should be able to ignore this if you aren’t using JSX. This tool lets us turn those <code class=\"language-text\">React.createElement</code> calls back into JSX. You will need to add jscodeshift first, as this is just a script we tell it to use on a directory of javascript files. Make sure everything looks good, and move on to the final step.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> global <span class=\"token function\">add</span> jscodeshift\n<span class=\"token function\">git</span> clone https://github.com/reactjs/react-codemod.git\n<span class=\"token function\">cd</span> ./react-codemod\n<span class=\"token function\">yarn</span> --no-lockfile\njscodeshift -t ./react-codemod/transforms/create-element-to-jsx.js ./scripts --no-explicit-require</code></pre></div>\n<h3 id=\"eslint\"><a href=\"#eslint\" aria-label=\"eslint permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/eslint/eslint\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ESLint</a></h3>\n<p>I recommend configuring a <code class=\"language-text\">.eslintrc</code>. You can install ESLint and have it automatically fix up the transpiled code. This final step will give you a much more readable and clean result.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> eslint --dev\n./node_modules/eslint/bin/eslint.js --fix ./scripts</code></pre></div>\n<h3 id=\"others\"><a href=\"#others\" aria-label=\"others permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Others</h3>\n<p>Below are some other tools that I found useful. You may find they give you false positives, so make sure to review all your changes carefully before committing. I hope these tools will help you out of a tight situation like the one I was in.</p>\n<ul>\n<li><a href=\"https://github.com/lebab/lebab\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Lebab</a></li>\n<li><a href=\"http://coffeescript.org/#usage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CoffeeScript</a></li>\n<li><a href=\"https://github.com/kriszyp/coffeetoes6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CoffeeToES6</a></li>\n</ul>","fields":{"slug":"/posts/coffee-to-babel/","tagSlugs":["/tag/java-script/","/tag/coffee-script/"]},"frontmatter":{"date":"2016-11-30T09:17:00.000Z","description":"How I quickly translated an entire frontend codebase from coffee to babel.","tags":["JavaScript","CoffeeScript"],"title":"Coffee to Babel in 24 hours"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/coffee-to-babel/"}}}