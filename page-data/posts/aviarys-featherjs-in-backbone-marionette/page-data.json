{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/aviarys-featherjs-in-backbone-marionette/","webpackCompilationHash":"c9a52c2757644449e755","result":{"data":{"markdownRemark":{"id":"ff646214-fc00-5e20-a769-ff5ed4f56345","html":"<p>To get started head over to the <a href=\"http://developers.aviary.com/\" title=\"Dev Page\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Developer Page</a> and sign up. Select the HTML 5 app and generate an api key. Place featherjs in a <a href=\"http://feather.aviary.com/js/feather.js\" title=\"FeatherJS\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">script tag or download it</a>.</p>\n<p>Now in your Backbone.Marionette app you are going to either create a new ItemView or navigate to an existing one you want aviary to be launched from.</p>\n<div class=\"gatsby-highlight\" data-language=\"coffeescript\"><pre class=\"language-coffeescript\"><code class=\"language-coffeescript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">App<span class=\"token punctuation\">.</span>AvatarView</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Backbone<span class=\"token punctuation\">.</span>Marionette<span class=\"token punctuation\">.</span>ItemView</span>\n  <span class=\"token property\">template</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'avatar'</span>\n  <span class=\"token property\">className</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'avatar_view'</span></code></pre></div>\n<p>Initialize Aviary by creating an instance of Feather JS. Do this in the initialize method of the ItemView. Here we construct what Aviary’s Editor will do throughout its use. When the user finishes saving the photo, a url is returned. You are left with several options. Insert the url into the DOM using the image id, save the new url to an attribute on your Backbone model, or directly post the url to your server. Make sure you store your api<em>key somewhere so you can access it from anywhere you might need to launch aviary. For this example I’ll store it in window.aviary</em>api_key.</p>\n<div class=\"gatsby-highlight\" data-language=\"coffeescript\"><pre class=\"language-coffeescript\"><code class=\"language-coffeescript\"><span class=\"token property\">initialize</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n  <span class=\"token class-member variable\">@featherEditor</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Aviary<span class=\"token punctuation\">.</span>Feather</span>\n    <span class=\"token property\">apiKey</span><span class=\"token punctuation\">:</span> aviary_api_key\n    <span class=\"token property\">apiVersion</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span> <span class=\"token comment\"># The latest api version</span>\n    <span class=\"token property\">tools</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'stickers'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'crop'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token property\">onSave</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n      <span class=\"token class-member variable\">@model</span><span class=\"token punctuation\">.</span>save\n        <span class=\"token property\">avatar_url</span><span class=\"token punctuation\">:</span> url\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">false</span> <span class=\"token comment\"># ignores the save/confirm dialog</span>\n    <span class=\"token property\">theme</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'light'</span> <span class=\"token comment\"># dark by default</span>\n    <span class=\"token property\">noCloseButton</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">true</span> <span class=\"token comment\"># You can force the user to continue using aviary this way.</span></code></pre></div>\n<p>Aviary also provides callback methods like onClose and onReady for additional control during various points of user interaction. Another useful param is postUrl. This allows you to post the newly edited photo to a route on your server or wherever you would like.</p>\n<p>You’re going to need a method that can start aviary from an event or some other place in your view. Let’s call this method launchEditor.</p>\n<div class=\"gatsby-highlight\" data-language=\"coffeescript\"><pre class=\"language-coffeescript\"><code class=\"language-coffeescript\"><span class=\"token property\">launchEditor</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span>\n  <span class=\"token comment\"># load a url now or pass it into this function</span>\n  <span class=\"token class-member variable\">@featherEditor</span><span class=\"token punctuation\">.</span>launch\n    <span class=\"token property\">image</span><span class=\"token punctuation\">:</span> id\n    <span class=\"token property\">url</span><span class=\"token punctuation\">:</span> src\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">false</span></code></pre></div>\n<p>If you would like to add a default cropping ratio you can do so by adding a ‘forceCropPreset’ to the params on launch like so.</p>\n<div class=\"gatsby-highlight\" data-language=\"coffeescript\"><pre class=\"language-coffeescript\"><code class=\"language-coffeescript\"><span class=\"token class-member variable\">@featherEditor</span><span class=\"token punctuation\">.</span>launch\n  <span class=\"token property\">image</span><span class=\"token punctuation\">:</span> id\n  <span class=\"token property\">url</span><span class=\"token punctuation\">:</span> src\n  <span class=\"token property\">forceCropPreset</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'My Default'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'1:1'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token property\">forceCropMessage</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Please Crop your Avatar'</span></code></pre></div>\n<p>At this point you can test that aviary is properly launching after calling the ‘launchEditor’ method. You may want to add a click listener to launch it. If you have a class named avatar, you could add an event to launch it.</p>\n<div class=\"gatsby-highlight\" data-language=\"coffeescript\"><pre class=\"language-coffeescript\"><code class=\"language-coffeescript\"><span class=\"token property\">events</span><span class=\"token punctuation\">:</span>\n  <span class=\"token string\">'click .avatar'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'launchEditor'</span></code></pre></div>\n<p>Aviary has <a href=\"http://developers.aviary.com/docs/web/setup-guide\" title=\"Aviary&#x27;s Feather Documentation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">documentation</a> on implementing feather. I don’t recommend reading the entire thing. Only pieces of it are useful for specific instances of aviary. I went over some of the more useful features you may want when using it with Avatars. But you can mix and match Aviary’s editor to fit your needs. Take a look at the various tools the editor offers to see what I mean.</p>\n<p>Remember, every external library comes with its hardships. Although it seems very simple to implement, Aviary only allows external resources to be used as (a publicly available file that they process) the url source. The url they return to you is always one from there servers. So if you don’t feel comfortable with aviary touching your users data remotely, I would look for other options. Such as manually cropping photos using the HTML 5 Canvas.</p>\n<p>Note: I had trouble with IE9, they claim to support it but I received ‘Not Enough Storage’ errors when launching Feather in IE. It appeared to be an issue with cascading style sheets, let me know if you have a similar result.</p>","fields":{"slug":"/posts/aviarys-featherjs-in-backbone-marionette/","tagSlugs":["/tag/java-script/","/tag/backbone/","/tag/marionette/","/tag/aviary/"]},"frontmatter":{"date":"2014-04-07T01:01:35.000Z","description":null,"tags":["JavaScript","Backbone","Marionette","Aviary"],"title":"Aviary's FeatherJS in Backbone.Marionette"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/aviarys-featherjs-in-backbone-marionette/"}}}