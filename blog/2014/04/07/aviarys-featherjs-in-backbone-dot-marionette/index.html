
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Aviary's FeatherJS in Backbone.Marionette - Dev Continuum</title>
  <meta name="author" content="Vincent Taverna">

  
  <meta name="description" content="To get started head over to the Developer Page and sign up. Select the HTML 5 app and generate an api key. Place featherjs in a script tag or &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://vinnymac.github.io/blog/2014/04/07/aviarys-featherjs-in-backbone-dot-marionette">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dev Continuum" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dev Continuum</a></h1>
  
    <h2>Web and Android Development</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:vinnymac.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Aviary's FeatherJS in Backbone.Marionette</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-07T01:01:35-04:00" pubdate data-updated="true">Apr 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>To get started head over to the <a href="http://developers.aviary.com/" title="Dev Page">Developer Page</a> and sign up. Select the HTML 5 app and generate an api key. Place featherjs in a <a href="http://feather.aviary.com/js/feather.js" title="FeatherJS">script tag or download it</a>.</p>

<p>Now in your Backbone.Marionette app you are going to either create a new ItemView or navigate to an existing one you want aviary to be launched from.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="k">class</span> <span class="nx">App</span><span class="p">.</span><span class="nx">AvatarView</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Marionette</span><span class="p">.</span><span class="nx">ItemView</span>
</span><span class='line'>  <span class="nv">template: </span><span class="s">&#39;avatar&#39;</span>
</span><span class='line'>  <span class="nv">className: </span><span class="s">&#39;avatar_view&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Initialize Aviary by creating an instance of Feather JS. Do this in the initialize method of the ItemView. Here we construct what Aviary&rsquo;s Editor will do throughout its use. When the user finishes saving the photo, a url is returned. You are left with several options. Insert the url into the DOM using the image id, save the new url to an attribute on your Backbone model, or directly post the url to your server. Make sure you store your api_key somewhere so you can access it from anywhere you might need to launch aviary. For this example I&rsquo;ll store it in window.aviary_api_key.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">initialize: </span><span class="nf">-&gt;</span>
</span><span class='line'>  <span class="vi">@featherEditor = </span><span class="k">new</span> <span class="nx">Aviary</span><span class="p">.</span><span class="nx">Feather</span>
</span><span class='line'>    <span class="nv">apiKey: </span><span class="nx">aviary_api_key</span>
</span><span class='line'>    <span class="nv">apiVersion: </span><span class="mi">3</span> <span class="c1"># The latest api version</span>
</span><span class='line'>    <span class="nv">tools: </span><span class="p">[</span><span class="s">&#39;stickers&#39;</span><span class="p">,</span> <span class="s">&#39;crop&#39;</span><span class="p">]</span>
</span><span class='line'>    <span class="nv">onSave: </span><span class="nf">(id, url) -&gt;</span>
</span><span class='line'>      <span class="nx">@model</span><span class="p">.</span><span class="nx">save</span>
</span><span class='line'>        <span class="nv">avatar_url: </span><span class="nx">url</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span> <span class="c1"># ignores the save/confirm dialog</span>
</span><span class='line'>    <span class="nv">theme: </span><span class="s">&#39;light&#39;</span> <span class="c1"># dark by default</span>
</span><span class='line'>    <span class="nv">noCloseButton: </span><span class="kc">true</span> <span class="c1"># You can force the user to continue using aviary this way.</span>
</span></code></pre></td></tr></table></div></figure>


<p>Aviary also provides callback methods like onClose and onReady for additional control during various points of user interaction. Another useful param is postUrl. This allows you to post the newly edited photo to a route on your server or wherever you would like.</p>

<p>You&rsquo;re going to need a method that can start aviary from an event or some other place in your view. Let&rsquo;s call this method launchEditor.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">launchEditor: </span><span class="nf">(id, src) -&gt;</span>
</span><span class='line'>  <span class="c1"># load a url now or pass it into this function</span>
</span><span class='line'>  <span class="nx">@featherEditor</span><span class="p">.</span><span class="nx">launch</span>
</span><span class='line'>    <span class="nv">image: </span><span class="nx">id</span>
</span><span class='line'>    <span class="nv">url: </span><span class="nx">src</span>
</span><span class='line'>  <span class="k">return</span> <span class="kc">false</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you would like to add a default cropping ratio you can do so by adding a &lsquo;forceCropPreset&rsquo; to the params on launch like so.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">@featherEditor</span><span class="p">.</span><span class="nx">launch</span>
</span><span class='line'>  <span class="nv">image: </span><span class="nx">id</span>
</span><span class='line'>  <span class="nv">url: </span><span class="nx">src</span>
</span><span class='line'>  <span class="nv">forceCropPreset: </span><span class="p">[</span><span class="s">&#39;My Default&#39;</span><span class="p">,</span> <span class="s">&#39;1:1&#39;</span><span class="p">]</span>
</span><span class='line'>  <span class="nv">forceCropMessage: </span><span class="s">&#39;Please Crop your Avatar&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>At this point you can test that aviary is properly launching after calling the &lsquo;launchEditor&rsquo; method. You may want to add a click listener to launch it. If you have a class named avatar, you could add an event to launch it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">events:</span>
</span><span class='line'>  <span class="s">&#39;click .avatar&#39;</span> <span class="o">:</span> <span class="s">&#39;launchEditor&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Aviary has <a href="http://developers.aviary.com/docs/web/setup-guide" title="Aviary's Feather Documentation">documentation</a> on implementing feather. I don&rsquo;t recommend reading the entire thing. Only pieces of it are useful for specific instances of aviary. I went over some of the more useful features you may want when using it with Avatars. But you can mix and match Aviary&rsquo;s editor to fit your needs. Take a look at the various tools the editor offers to see what I mean.</p>

<p>Remember, every external library comes with its hardships. Although it seems very simple to implement, Aviary only allows external resources to be used as (a publicly available file that they process) the url source. The url they return to you is always one from there servers. So if you don&rsquo;t feel comfortable with aviary touching your users data remotely, I would look for other options. Such as manually cropping photos using the HTML 5 Canvas.</p>

<p>Note: I had trouble with IE9, they claim to support it but I received &lsquo;Not Enough Storage&rsquo; errors when launching Feather in IE. It appeared to be an issue with cascading style sheets, let me know if you have a similar result.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Vincent Taverna</span></span>

      








  


<time datetime="2014-04-07T01:01:35-04:00" pubdate data-updated="true">Apr 7<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/aviary/'>Aviary</a>, <a class='category' href='/blog/categories/backbone/'>Backbone</a>, <a class='category' href='/blog/categories/marionette/'>Marionette</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://vinnymac.github.io/blog/2014/04/07/aviarys-featherjs-in-backbone-dot-marionette/" data-via="kidtheflash" data-counturl="http://vinnymac.github.io/blog/2014/04/07/aviarys-featherjs-in-backbone-dot-marionette/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
      
        <a class="basic-alignment right" href="/blog/2014/04/14/client-side-exif/" title="Next Post: Client-Side EXIF">Client-Side EXIF &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/05/11/fragment-factories/">Fragment Factories</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/05/promises-and-more/">Promises and More</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/28/html5-video-and-audio/">HTML5 Video and Audio</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/21/jasmine-and-teaspoon/">Jasmine and Teaspoon</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/14/client-side-exif/">Client-Side EXIF</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/vinnymac">@vinnymac</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'vinnymac',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Vincent Taverna -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
